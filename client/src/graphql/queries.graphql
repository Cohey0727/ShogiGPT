query Health {
  health {
    status
    timestamp
  }
}

query GetMatches {
  matches(orderBy: { createdAt: DESC }) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    matchStates(orderBy: { index: ASC }) {
      id
      createdAt
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
    }
    chatMessages(orderBy: { createdAt: ASC }) {
      id
      createdAt
      matchId
      role
      content
      metadata
    }
  }
}

query GetChatMessages($matchId: String!) {
  chatMessages(
    where: { matchId: { _eq: $matchId } }
    orderBy: { createdAt: ASC }
  ) {
    id
    createdAt
    matchId
    role
    content
    metadata
  }
}

subscription SubscribeChatMessages($matchId: String!) {
  chatMessages(
    where: { matchId: { _eq: $matchId } }
    orderBy: { createdAt: ASC }
  ) {
    id
    createdAt
    matchId
    role
    content
    metadata
  }
}

mutation CreateMatch($playerSente: String, $playerGote: String) {
  insertMatchesOne(
    object: { playerSente: $playerSente, playerGote: $playerGote }
  ) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    matchStates(orderBy: { index: ASC }) {
      id
      createdAt
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
    }
    chatMessages(orderBy: { createdAt: ASC }) {
      id
      createdAt
      matchId
      role
      content
      metadata
    }
  }
}

mutation SendChatMessage($matchId: String!, $content: String!) {
  sendChatMessage(input: { matchId: $matchId, content: $content }) {
    userMessage {
      id
      matchId
      role
      content
      createdAt
    }
    assistantMessage {
      id
      matchId
      role
      content
      createdAt
    }
  }
}

mutation AnalyzePosition($input: AnalysisInput!) {
  analyzePosition(input: $input) {
    bestmove
    variations {
      move
      scoreCp
      scoreMate
      depth
      nodes
      pv
    }
    timeMs
    engineName
  }
}
