query Health {
  health {
    status
    timestamp
  }
}

query GetMatches {
  matches(orderBy: { createdAt: DESC }) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    matchStates(orderBy: { index: ASC }) {
      id
      createdAt
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
    }
    chatMessages(orderBy: { createdAt: ASC }) {
      id
      createdAt
      matchId
      role
      content
      metadata
    }
  }
}

query GetChatMessages($matchId: String!) {
  chatMessages(
    where: { matchId: { _eq: $matchId } }
    orderBy: { createdAt: ASC }
  ) {
    id
    createdAt
    matchId
    role
    content
    metadata
  }
}

subscription SubscribeChatMessages($matchId: String!) {
  chatMessages(
    where: { matchId: { _eq: $matchId } }
    orderBy: { createdAt: ASC }
  ) {
    id
    createdAt
    matchId
    role
    content
    metadata
  }
}

mutation CreateMatch($playerSente: String, $playerGote: String) {
  insertMatchesOne(
    object: { playerSente: $playerSente, playerGote: $playerGote }
  ) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    matchStates(orderBy: { index: ASC }) {
      id
      createdAt
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
    }
    chatMessages(orderBy: { createdAt: ASC }) {
      id
      createdAt
      matchId
      role
      content
      metadata
    }
  }
}

mutation CreateChatMessage(
  $matchId: String!
  $role: MessageRole!
  $content: String!
  $metadata: String
) {
  insertChatMessagesOne(
    object: {
      matchId: $matchId
      role: $role
      content: $content
      metadata: $metadata
    }
  ) {
    id
    createdAt
    matchId
    role
    content
    metadata
  }
}

mutation AnalyzePosition($input: AnalysisInput!) {
  analyzePosition(input: $input) {
    bestmove
    variations {
      move
      scoreCp
      scoreMate
      depth
      nodes
      pv
    }
    timeMs
    engineName
  }
}
