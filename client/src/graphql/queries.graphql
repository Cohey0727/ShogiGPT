query Health {
  health {
    status
    timestamp
  }
}

query GetMatches {
  matches(orderBy: { createdAt: DESC }) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    senteType
    goteType
    matchStates(orderBy: { index: ASC }) {
      createdAt
      matchId
      index
      usiMove
      sfen
      thinkingTime
    }
    chatMessages(orderBy: { createdAt: ASC }) {
      id
      createdAt
      matchId
      role
      contents
      metadata
    }
  }
}

query GetMatch($matchId: String!) {
  matchesByPk(id: $matchId) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    senteType
    goteType
    matchStates(orderBy: { index: ASC }) {
      createdAt
      matchId
      index
      usiMove
      sfen
      thinkingTime
    }
  }
}

query GetChatMessages($matchId: String!) {
  chatMessages(where: { matchId: { _eq: $matchId } }, orderBy: { createdAt: ASC }) {
    id
    createdAt
    matchId
    role
    contents
    metadata
  }
}

subscription SubscribeChatMessages($matchId: String!) {
  chatMessages(where: { matchId: { _eq: $matchId } }, orderBy: { createdAt: ASC }) {
    id
    createdAt
    matchId
    role
    contents
    metadata
    isPartial
  }
}

subscription SubscribeMatchStates($matchId: String!) {
  matchStates(where: { matchId: { _eq: $matchId } }, orderBy: { index: ASC }) {
    createdAt
    matchId
    index
    usiMove
    sfen
    thinkingTime
    evaluation {
      id
      sfen
      engineName
      variations
      createdAt
      updatedAt
    }
  }
}

mutation StartMatch(
  $id: String
  $playerSente: String
  $playerGote: String
  $senteType: PlayerType!
  $goteType: PlayerType!
) {
  startMatch(
    input: {
      id: $id
      playerSente: $playerSente
      playerGote: $playerGote
      senteType: $senteType
      goteType: $goteType
    }
  ) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    senteType
    goteType
  }
}

mutation SendChatMessage($matchId: String!, $content: String!, $aiPersonality: AiPersonality) {
  sendChatMessage(input: { matchId: $matchId, content: $content, aiPersonality: $aiPersonality }) {
    success
  }
}
