query Health {
  health {
    status
    timestamp
  }
}

query GetMatches {
  matches(orderBy: { createdAt: DESC }) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    senteType
    goteType
    matchStates(orderBy: { index: ASC }) {
      id
      createdAt
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
    }
    chatMessages(orderBy: { createdAt: ASC }) {
      id
      createdAt
      matchId
      role
      content
      metadata
    }
  }
}

query GetMatch($matchId: String!) {
  matchesByPk(id: $matchId) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    senteType
    goteType
    matchStates(orderBy: { index: ASC }) {
      id
      createdAt
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
    }
  }
}

query GetChatMessages($matchId: String!) {
  chatMessages(
    where: { matchId: { _eq: $matchId } }
    orderBy: { createdAt: ASC }
  ) {
    id
    createdAt
    matchId
    role
    content
    metadata
  }
}

subscription SubscribeChatMessages($matchId: String!) {
  chatMessages(
    where: { matchId: { _eq: $matchId } }
    orderBy: { createdAt: ASC }
  ) {
    id
    createdAt
    matchId
    role
    content
    metadata
    isPartial
  }
}

mutation CreateMatch(
  $id: String
  $playerSente: String
  $playerGote: String
  $senteType: PlayerType
  $goteType: PlayerType
) {
  createMatch(
    input: {
      id: $id
      playerSente: $playerSente
      playerGote: $playerGote
      senteType: $senteType
      goteType: $goteType
    }
  ) {
    id
    createdAt
    updatedAt
    status
    playerSente
    playerGote
    senteType
    goteType
  }
}

mutation SendChatMessage($matchId: String!, $content: String!) {
  sendChatMessage(input: { matchId: $matchId, content: $content }) {
    userMessage {
      id
      matchId
      role
      content
      createdAt
    }
    assistantMessage {
      id
      matchId
      role
      content
      createdAt
    }
  }
}

mutation SaveMatchStateAndGetCandidates($input: SaveMatchStateInput!) {
  saveMatchStateAndGetCandidates(input: $input) {
    matchState {
      id
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
      createdAt
    }
    candidates {
      move
      scoreCp
      scoreMate
      depth
      nodes
      pv
    }
  }
}

mutation EvaluateMatchState($input: EvaluateMatchStateInput!) {
  evaluateMatchState(input: $input) {
    success
    matchState {
      id
      matchId
      index
      moveNotation
      player
      sfen
      thinkingTime
      createdAt
    }
    thinkingMessage {
      id
      matchId
      role
      content
      isPartial
      createdAt
    }
  }
}
