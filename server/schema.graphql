type Query {
  health: Health!
  getMatches: [Match!]!
}

type Mutation {
  createMatch(input: CreateMatchInput!): Match!
  createMatchState(input: CreateMatchStateInput!): MatchState!
  createChatMessage(input: CreateChatMessageInput!): ChatMessage!
  analyzePosition(input: AnalysisInput!): AnalysisResult!
}

type Health {
  status: String!
  timestamp: String!
}

"""
局面解析リクエスト
"""
input AnalysisInput {
  """
  SFEN形式の局面文字列（省略時は平手初期局面）
  """
  sfen: String
  """
  初期局面からの指し手リスト（USI形式）
  """
  moves: [String!]
  """
  思考時間（ミリ秒、デフォルト: 1000）
  """
  timeMs: Int
  """
  探索深さ（指定時はtimeMsを無視）
  """
  depth: Int
  """
  候補手の数（MultiPV、デフォルト: 1）
  """
  multipv: Int
}

"""
局面解析結果
"""
type AnalysisResult {
  """
  最善手（USI形式）
  """
  bestmove: String!
  """
  候補手リスト（MultiPV）
  """
  variations: [MoveVariation!]!
  """
  実際の思考時間（ミリ秒）
  """
  timeMs: Int!
  """
  エンジン名
  """
  engineName: String!
}

"""
1つの候補手情報
"""
type MoveVariation {
  """
  指し手（USI形式）
  """
  move: String!
  """
  評価値（センチポーン）
  """
  scoreCp: Int
  """
  詰みまでの手数（プライ数）
  """
  scoreMate: Int
  """
  探索深さ
  """
  depth: Int!
  """
  探索ノード数
  """
  nodes: Int
  """
  読み筋（PV）
  """
  pv: [String!]
}

"""
対局状況
"""
enum MatchStatus {
  ONGOING
  COMPLETED
  ABANDONED
}

"""
プレイヤー
"""
enum Player {
  SENTE
  GOTE
}

"""
メッセージ送信者ロール
"""
enum MessageRole {
  USER
  ASSISTANT
  SYSTEM
}

"""
対局情報
"""
type Match {
  id: ID!
  createdAt: String!
  updatedAt: String!
  status: MatchStatus!
  playerSente: String
  playerGote: String
  states: [MatchState!]!
  messages: [ChatMessage!]!
}

"""
局面情報
"""
type MatchState {
  id: ID!
  createdAt: String!
  matchId: ID!
  index: Int!
  moveNotation: String
  player: Player!
  sfen: String!
  thinkingTime: Int
}

"""
チャットメッセージ
"""
type ChatMessage {
  id: ID!
  createdAt: String!
  matchId: ID!
  role: MessageRole!
  content: String!
  metadata: String
}

"""
対局作成入力
"""
input CreateMatchInput {
  """
  先手のプレイヤー名
  """
  playerSente: String
  """
  後手のプレイヤー名
  """
  playerGote: String
}

"""
局面作成入力
"""
input CreateMatchStateInput {
  """
  対局ID
  """
  matchId: ID!
  """
  局面番号
  """
  index: Int!
  """
  指し手（USI形式）
  """
  moveNotation: String
  """
  手番プレイヤー
  """
  player: Player!
  """
  盤面（SFEN形式）
  """
  sfen: String!
  """
  消費時間（秒）
  """
  thinkingTime: Int
}

"""
チャットメッセージ作成入力
"""
input CreateChatMessageInput {
  """
  対局ID
  """
  matchId: ID!
  """
  送信者ロール
  """
  role: MessageRole!
  """
  メッセージ本文
  """
  content: String!
  """
  メタデータ（JSON形式）
  """
  metadata: String
}
